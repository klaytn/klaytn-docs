# Ethereum Transaction Types <a id="ethereum-transaction-types"></a>

Klaytn provides wrapped transaction types to support Ethereum compatibility. Ethereum transaction types in Klaytn have the same attributes and RLP encoding schemes with Ethereum's design except for a single byte type delimiter called EthereumTxTypeEnvelope. Therefore, users can successfully deploy transactions generated by Ethereum development tools to Klaytn. Even the type delimiter is omitted when users use `eth` namespace APIs, so they can use Klaytn as if they were using Ethereum. Using `klay` namespace APIs, users can deploy and retrieve an Ethereum typed transaction as one sort of Klaytn transaction without the confusion with the existing Klaytn transaction types.  


## EthereumTxTypeEnvelope <a id="ethereumtxtypeenvelope"></a>

EthereumTxTypeEnvelope is a single byte prefix for a raw transaction. It denotes Ethereum transaction types. Ethereum has adopted an extendable transaction type scheme from [EIP-2718](https://eips.ethereum.org/EIPS/eip-2718) and it uses a type numbering system that conflicts with Klaytn. To resolve the conflict between two different transaction type schemes, Klaytn has introduced EthereumTxTypeEnvelope that provides separability as well as expandability for future Ethereum transaction types. 

EthereumTxTypeEnvelope is an additional type delimeter and used only for raw transactions and type numbering. It is not used for transaction hash or signature hash. For them, only EthereumTransactionType defined in EIPs is used like Ethereum. 
- EthereumTxTypeEnvelope: `0x78`
- TxHashRLP : EthereumTransactionType || TransactionPayload
- RawTransaction : EthereumTxTypeEnvelope || EthereumTransactionType || TransactionPayload


## TxTypeEthereumAccessList <a id="txtypeethereumaccesslist"></a>

TxTypeEthereumAccessList represents a type of Ethereum transaction specified in [EIP-2930](https://eips.ethereum.org/EIPS/eip-2930). This transactions type contains an access list, a list of addresses and storage keys that the transaction is supposed to access. Since this transaction type exists to support compatibility, it only works with EOAs associated with [AccountKeyLegacy]. EOAs associated with other account key types should use other transaction types such as TxTypeValueTransfer, TxTypeSmartContractExecution, and so on. This type of transaction can create an account, transfer tokens, deploy a smart contract, execute a smart contract, or perform a mix of the aforementioned. 

{% hint style="success" %} 
NOTE: Klaytn networks are able to process this transaction type after `EthTxTypeCompatibleBlock`
{% endhint %}

{% hint style="success" %} 
NOTE: This transaction type only supports a format of the Ethereum transaction type. Unlike [EIP-2930](https://eips.ethereum.org/EIPS/eip-2930), there is no benefit of transaction fee from the access list.
{% endhint %}

### Attributes <a id="attributes"></a>

| Attribute | Type | Description |
| :--- | :--- | :--- |
| type | uint8 \(Go\) | The type of TxTypeEthereumAccessList that is a concatenation of EthereumTxTypeEnvelope and EthereumTransactionType. This must be 0x7801. |  
| chainId | \*big.Int \(Go\) | The destination chain ID. |
| nonce | uint64 \(Go\) | A value used to uniquely identify a sender’s transaction. If two transactions with the same nonce are generated by a sender, only one is executed. |
| gasPrice | \*big.Int \(Go\) | A multiplier to get how much the sender will pay in tokens. The amount of tokens the sender will pay is calculated via `gas` \* `gasPrice`. For example, the sender will pay 10 KLAY for a transaction fee if gas is 10 and gasPrice is 10^18. See [Unit of KLAY]. |
| gas | uint64 \(Go\) | The maximum amount of transaction fee the transaction is allowed to use. |
| to | \*common.Address \(Go\) | The account address that will receive the transferred value. |
| value | \*big.Int \(Go\) | The amount of KLAY in `peb` to be transferred. |
| data | \[\]byte \(Go\) | Data attached to the transaction, used for transaction execution. |
| accessList | type.AccessList \(Go\) | A list of addresses and storage keys consists of \[\](common.Address, []common.Hash). |
| v, r, s | \*big.Int \(Go\) | The cryptographic signature generated by the sender to let the receiver obtain the sender's address. |

### RLP Encoding for Signature <a id="rlp-encoding-for-signature"></a>

To make a signature of this transaction type, RLP serialization should be done like the following:

{% hint style="success" %} 
NOTE: This type of transaction should be signed with London Signer
{% endhint %}

```javascript
SigRLP = EthereumTransactionType || encode([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList])
SigHash = keccak256(SigRLP)
Signature = sign(SigHash, <private key>)
```

### RLP Encoding for SenderTxHash <a id="rlp-encoding-for-sendertxhash"></a>

To make a SenderTxHash, RLP serialization should be done like the following:

```javascript
SenderTxHashRLP = EthereumTransactionType || encode([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList, v, r, s])
SenderTxHash = keccak256(SenderTxHashRLP)
Signature = sign(SenderTxHash, <private key>)
```

### RLP Encoding for Transaction Hash <a id="rlp-encoding-for-transaction-hash"></a>

To make a transaction hash, RLP serialization should be done like the following:

```javascript
TxHashRLP = EthereumTransactionType || encode([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList, v, r, s])
TxHash = keccak256(TxHashRLP)
```

### Raw Transaction <a id="raw-transaction"></a>
```javascript
RawTx = EthereumTxTypeEnvelope || EthereumTransactionType || encode([chainId, nonce, gasPrice, gasLimit, to, value, data, accessList, v, r, s])
```

### RLP Encoding \(Example\) <a id="rlp-encoding-example"></a>

The following shows the result of RLP serialization and the transaction object:

```javascript
    TX(3a3ab67168de40b1f8a2141a70a4e2f551f90d7814b2fbcb3ac99ad8d8d0b641)
    Contract: false
    Chaind:   0x2
    From:     a94f5374fce5edbc8e2a8697c15331677e6ebf0b
    To:       7b65b75d204abed71587c9e519a89277766ee1d0
    Nonce:    1234
    GasPrice: 0x19
    GasLimit  0xf4240
    Value:    0xa
    Data:     0x31323334
    AccessList: [{0000000000000000000000000000000000000001 [0000000000000000000000000000000000000000000000000000000000000000]}]
    V:        0x1
    R:        0xbfc80a874c43b71b67c68fa5927d1443407f31aef4ec6369bbecdb76fc39b0c0
    S:        0x193e62c1dd63905aee7073958675dcb45d78c716a9a286b54a496e82cb762f26
    Hex:      7801f8a1028204d219830f4240947b65b75d204abed71587c9e519a89277766ee1d00a8431323334f838f7940000000000000000000000000000000000000001e1a0000000000000000000000000000000000000000000000000000000000000000001a0bfc80a874c43b71b67c68fa5927d1443407f31aef4ec6369bbecdb76fc39b0c0a0193e62c1dd63905aee7073958675dcb45d78c716a9a286b54a496e82cb762f26
        

```

### RPC Output \(Example\) <a id="rpc-output-example"></a>

The following shows a transaction object returned via JSON RPC.

```javascript
TBU
```


## TxTypeEthereumDynamicFee <a id="txtypeethereumdynamicfee"></a>

TxTypeEthereumDynamicFee represents a type of Ethereum transaction specified in [EIP-1559](https://eips.ethereum.org/EIPS/eip-1559). This transaction type contains a gasTipCap and a gasFeeCap instead of gasPrice. Since this transaction type exists to support compatibility, it only works with EOAs associated with [AccountKeyLegacy]. EOAs associated with other account key types should use other transaction types such as TxTypeValueTransfer, TxTypeSmartContractExecution, and so on. This type of transaction can create an account, transfer tokens, deploy a smart contract, execute a smart contract, or perform a mix of the aforementioned. 

{% hint style="success" %} 
NOTE: Klaytn networks are able to process this transaction type after `EthTxTypeCompatibleBlock`
{% endhint %}

{% hint style="success" %} 
NOTE: Currently, this type of transaction only supports a format of Ethereum transaction type. Unlike [EIP-2930](https://eips.ethereum.org/EIPS/eip-2930), there is no benefit of transaction fee from the access list.
{% endhint %}

{% hint style="success" %} 
NOTE: Since Klaytn has adopted a unit gas price policy, `gasTipCap` and `gasFeeCap` should be the same value as the network unit gas price such as 25 ston.
{% endhint %}

### Attributes <a id="attributes"></a>

| Attribute | Type | Description |
| :--- | :--- | :--- |
| type | uint8 \(Go\) | The type of TxTypeEthereumDynamicFee that is a concatenation of EthereumTxTypeEnvelope and EthereumTransactionType. This must be 0x7802. |  
| chainId | \*big.Int \(Go\) | The destination chain ID. |
| nonce | uint64 \(Go\) | A value used to uniquely identify a sender’s transaction. If two transactions with the same nonce are generated by a sender, only one is executed. |
| gasTipCap | \*big.Int \(Go\) | A multiplier to get how much the sender will pay in addition to `baseFee`. Since Klaytn has adopted a unit gas price policy, it should be the same value as the network unit gas price such as 25 ston. |
| gasFeeCap | \*big.Int \(Go\) | A multiplier to get how much the sender will pay in tokens. The amount of tokens the sender will pay is calculated via `gas` \* `gasFeeCap`. Since Klaytn has adopted a unit gas price policy, it should be the same value as the network unit gas price such as 25 ston. |
| gas | uint64 \(Go\) | The maximum amount of transaction fee the transaction is allowed to use. |
| to | \*common.Address \(Go\) | The account address that will receive the transferred value. |
| value | \*big.Int \(Go\) | The amount of KLAY in `peb` to be transferred. |
| data | \[\]byte \(Go\) | Data attached to the transaction, used for transaction execution. |
| accessList | type.AccessList \(Go\) | A list of addresses and storage keys consists of \[\](common.Address, []common.Hash). |
| v, r, s | \*big.Int \(Go\) | The cryptographic signature generated by the sender to let the receiver obtain the sender's address. |

### RLP Encoding for Signature <a id="rlp-encoding-for-signature"></a>

To make a signature of this transaction type, RLP serialization should be done like the following:

{% hint style="success" %} 
NOTE: This type of transaction should be signed with London Signer
{% endhint %}

```javascript
SigRLP = EthereumTransactionType || encode([chainId, nonce, gasTipCap, gasFeeCap, gasLimit, to, value, data, accessList])
SigHash = keccak256(SigRLP)
Signature = sign(SigHash, <private key>)
```

### RLP Encoding for SenderTxHash <a id="rlp-encoding-for-sendertxhash"></a>

To make a SenderTxHash, RLP serialization should be done like the following:

```javascript
SenderTxHashRLP = EthereumTransactionType || encode([chainId, nonce, gasTipCap, gasFeeCap, gasLimit, to, value, data, accessList, v, r, s])
SenderTxHash = keccak256(SenderTxHashRLP)
Signature = sign(SenderTxHash, <private key>)
```

### RLP Encoding for Transaction Hash <a id="rlp-encoding-for-transaction-hash"></a>

To make a transaction hash, RLP serialization should be done like the following:

```javascript
TxHashRLP = EthereumTransactionType || encode([chainId, nonce, gasTipCap, gasFeeCap, gasLimit, to, value, data, accessList, v, r, s])
TxHash = keccak256(TxHashRLP)
```

### Raw Transaction <a id="raw-transaction"></a>
```javascript
RawTx = EthereumTxTypeEnvelope || EthereumTransactionType || encode([chainId, nonce, gasTipCap, gasFeeCap, gasLimit, to, value, data, accessList, v, r, s])
```

### RLP Encoding \(Example\) <a id="rlp-encoding-example"></a>

The following shows the result of RLP serialization and the transaction object:

```javascript
    TX(be74e122acf00c2f257e8698ecf01140b58b2880de3f24d0875730425eccb45a)
    Contract: false
    Chaind:   0x2
    From:     a94f5374fce5edbc8e2a8697c15331677e6ebf0b
    To:       7b65b75d204abed71587c9e519a89277766ee1d0
    Nonce:    1234
    GasTipCap: 0x19
    GasFeeCap: 0x19
    GasLimit  0xf4240
    Value:    0xa
    Data:     0x31323334
    AccessList: [{0000000000000000000000000000000000000001 [0000000000000000000000000000000000000000000000000000000000000000]}]
    V:        0x0
    R:        0xca14aa0bada2da7ca1b143c16e2dd4a69f2a1e77ce54c7f6d440fe828a777f4f
    S:        0x117f0f78aed398b2995b5ee7c67ace25d52be3c72c1384c2aaa9683b351556
    Hex:      7802f8a1028204d21919830f4240947b65b75d204abed71587c9e519a89277766ee1d00a8431323334f838f7940000000000000000000000000000000000000001e1a0000000000000000000000000000000000000000000000000000000000000000080a0ca14aa0bada2da7ca1b143c16e2dd4a69f2a1e77ce54c7f6d440fe828a777f4f9f117f0f78aed398b2995b5ee7c67ace25d52be3c72c1384c2aaa9683b351556
```

### RPC Output \(Example\) <a id="rpc-output-example"></a>

The following shows a transaction object returned via JSON RPC.

```javascript
TBU
```