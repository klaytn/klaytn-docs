# Nhật ký nút

Trang này trình bày chi tiết một số nội dung bản ghi quan trọng hoặc thường có thắc mắc từ các nút Klaytn.
Nếu bản ghi Klaytn được sửa đổi hoặc mới được thêm/xóa, vui lòng chỉnh sửa cả trang này.

Để biết thêm thông tin chi tiết về các loại bản ghi, bạn có thể tham khảo [log_modules.go](https://github.com/klaytn/klaytn/blob/dev/log/log_modules.go)

Nếu bạn gặp phải bất kỳ tình huống bất thường nào, vui lòng báo cáo cho đội ngũ Klaytn qua [github](https://github.com/klaytn/klaytn/issues), [Klaytn Forum](https://forum.klaytn.foundation/) hoặc [Discord](https://discord.io/KlaytnOfficial).

## Nhật ký lỗi

| Loại bản ghi          | Kiểu nút                        | Thông báo bản ghi                                                                                                                                                                                                        | Mô tả                                                                                                                                                                                                                                                                                                                                                       | Hướng dẫn đề xuất                                                                                                                                                                                                                          |
| :-------------------- | :------------------------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Blockchain            | CN/PN/EN                        | ########## BAD BLOCK #########<br/>Cấu hình chuỗi: %v<br/><br/>Số: %v<br/>Hàm băm: 0x%x<br/>%v<br/><br/>Lỗi: %v<br/>##############################                                                                       | Khối không hợp lệ phát sinh khi biên lai nhận được và kết quả thực thi không khớp nhau. Nếu một nút dừng lại với bản ghi khối không hợp lệ, có thể do hai lý do.  <br/> - Trường hợp 1. Cấu hình nút không chính xác, chẳng hạn như phiên bản nhị phân.  <br/> - Trường hợp 2. Mã có vấn đề. Rất có khả năng các nút khác cũng sẽ gặp phải vấn đề tương tự. | Đây là lỗi nghiêm trọng nên nếu bạn thấy bất kỳ khối không hợp lệ nào, vui lòng tạo báo cáo lỗi hoặc báo cáo cho kho lưu trữ Klaytn GitHub.                                                                                                |
| ConsensusIstanbulCore | CN/PN/EN                        | **Drop an empty message from timeout channel**                                                                                                                                                                           | Lỗi này có nghĩa là thời gian chuyển vòng sẽ hết. Lỗi này được in nếu bộ đếm thời gian vô tình đóng lại.                                                                                                                                                                                                                                                    | Lỗi này có thể xảy ra khi trình tải xuống được khởi động.  <br/> kiểm tra xem bản ghi tiếp theo có được in không: `Block synchronisation started`.                                                                                         |
| NetworksP2P           | CN/PN/EN                        | **Protocol istanbul/64 failed** id=04680a827fa1b240 conn=staticdial err="write tcp 10.117.2.105:34396->10.117.2.27:32323: use of closed etwork connection"<br/><br/> **Protocol istanbul/64 failed** err="shutting down" | Nhật ký này có thể được in nếu nút còn lại bị mất kết nối. Thông thường, tiếp theo sẽ là bản ghi `Disconnected a P2P Peer`.                                                                                                                                                                                                                                 | Kiểm tra xem máy ngang hàng bị mất kết nối có kết nối lại hay không. Nếu không có kết nối lại, hãy kiểm tra trạng thái mạng hoặc kết nối máy ngang hàng [admin_peers](../../references/json-rpc/admin.md#admin_peers) |
| NodeCN                | CN                              | **fail to SendNewBlockHashes** err="write tcp 10.117.2.124:24108->10.117.2.108:32323: use of closed network connection" <br/><br/> **fail to SendNewBlockHashes** err="shutting down"                                    | giống như lỗi `Protocol istanbul/64 failed`                                                                                                                                                                                                                                                                                                                 | giống như lỗi `Protocol istanbul/64 failed`                                                                                                                                                                                                |
| NodeCN                | CN                              | **fail to SendNewBlock** peer=d35220eccdb0de7b err="shutting down"                                                                                                                                                       | giống như lỗi `Protocol istanbul/64 failed`                                                                                                                                                                                                                                                                                                                 | giống như lỗi `Protocol istanbul/64 failed`                                                                                                                                                                                                |
| NetworksRPC           | EN (hầu hết) | **FastWebsocketHandler fail to upgrade message** error="websocket: version != 13"                                                                                                                                        | Vấn đề về phiên bản của kết nối WebSocket                                                                                                                                                                                                                                                                                                                   | Tiêu đề của yêu cầu phải chứa trường `Sec-Websocket-Version` với giá trị được đặt là 13. Có thể bạn chưa sử dụng máy khách Klaytn rpc.                                                                                                     |

## Nhật ký cảnh báo

| Loại bản ghi          | Kiểu nút | Thông báo bản ghi                                                                                                                                                                              | Mô tả                                                                                                                                                                                                                                                                                           | Hướng dẫn đề xuất                                                                                                                                                                                                                                                                    |
| :-------------------- | :------- | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Blockchain            | CN/PN/EN | **Upgrade database version** từ=N/A đến=3                                                                                                                                                      | Lỗi này được ghi bản ghi vào thời điểm bắt đầu khởi động nút                                                                                                                                                                                                                                    | Bạn không cần xử lý lỗi này.                                                                                                                                                                                                                                                         |
| ConsensusIstanbulCore | CN       | **[RC]** vòng=                                                                                                                             | Nhật ký thay đổi vòng lặp được bắt đầu với thẻ [RC].                                                                                                                                                                                        | Nếu vòng lặp không kết thúc sau một hoặc hai vòng và tiếp tục tăng lên thì trước tiên nên phân tích trạng thái mạng hoặc kết nối máy ngang hàng.  <br/><br/> api kiểm tra kết nối máy ngang hàng: [admin_peers](../../references/json-rpc/admin.md#admin_peers) |
| ConsensusIstanbulCore | CN       | **unexpected request**  address= state="Accept request" seq=312 err="old message" number=311 hash=d960ea…6df6de                                                                                | Một người đề xuất đào một khối nhưng không thành công. Trong hầu hết các trường hợp, khối đó quá cũ để làm khối mới.                                                                                                                                                                            | Bạn không cần xử lý lỗi này.                                                                                                                                                                                                                                                         |
| Node                  | CN/PN/EN | **Failed doConnTypeHandshake** addr=10.117.2.252:28516 conn=inbound conntype=-1 err="read tcp 10.117.2.78:32324->10.117.2.252:28516: i/o timeout                                               | Bằng cách quay số, hai máy ngang hàng P2P thiết lập kết nối. Nhật ký này được in nếu thiết lập không thành công.                                                                                                                                                                                | Kiểm tra xem máy ngang hàng bị mất kết nối có kết nối lại hay không. Nếu không, kiểm tra trạng thái mạng hoặc kết nối máy ngang hàng <br/><br/> api kiểm tra kết nối máy ngang hàng: [admin_peers](../../references/json-rpc/admin.md#admin_peers)              |
| NodeCN                | PN/EN    | **Failed to bộ lọc bodies** peer=c02e4b4d471c56b9 lenTxs=1                                                                                                                                     | Một nút đã nhận được phần tiêu đề khối không mong muốn khi đang tiến hành tìm nạp (fetching).  - lenTxs: số lượng giao dịch không được yêu cầu                                                                                                                               | Bạn không cần xử lý lỗi này.                                                                                                                                                                                                                                                         |
| Work                  | CN       | **Transaction aborted due to time limit** hash=                                                                                                                                                | Thời gian thực thi khối khi đào không được vượt quá 250 mili giây, vì vậy giao dịch cuối cùng có thể bị hủy do giới hạn thời gian này.                                                                                                                                                          | Xác nhận rằng giao dịch đi vào khối.                                                                                                                                                                                                                                                 |
| Work                  | CN       | **Transaction failed, tài khoản skipped** hash=b1b26c...6b220a err="insufficient balance for transfer"<br/><br/>Error(trước v1.6.2)<br/>Warn(sau v1.6.2) | Khi không thể thực thi một giao dịch trong quá trình đào do không đủ số dư trong tài khoản `from` <br/>(Về mặt lý thuyết, lỗi này xảy ra khi số dư vẫn đủ vào thời điểm giao dịch được tạo và nhập vào txpool, nhưng lại không đủ vào thời điểm thực thi giao dịch thực tế.) | Kiểm tra xem số dư tài khoản `from` có thực sự không đủ hay không.                                                                                                                                                                                                                   |

## Nhật ký thông tin

Nhật ký `Info` chứa thông tin bổ sung để bạn biết thêm về trạng thái nút nên bạn không cần xử lý bản ghi cấp độ `Info`.

| Loại bản ghi   | Kiểu nút | Thông báo bản ghi                                                                                                                                                                                                                 | Mô tả                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| :------------- | :------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Blockchain     | CN/PN/EN | **Regenerated local transaction journal** transactions=0 tài khoảns=0                                                                                                                                                             | Khi tắt nút, các giao dịch cục bộ được ghi vào một tập tin (tên tập tin mặc định là transactions.rlp). Khi nút được khởi động lại với tập tin đã ghi bản ghi, các giao dịch cục bộ có thể được tạo lại dựa trên tập tin.  - transactions: số lượng giao dịch cục bộ được tạo lại.  - tài khoảns: số lượng tài khoản được tạo lại (==from)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| Blockchain     | CN/PN/EN | **Inserted a new block** number=14 hash=13cbfc…f007fc txs=0 gas=0 elapsed=793.458µs  processTxs=167ns finalize=157.708µs validateState=7.542µs totalWrite=443.417µs trieWrite=256.667µs                                           | Nếu nút không phải là người đề xuất tại khối đó và đồng thuận thành công thì nút đó đã thực thi (== xác thực) khối. Nói cách khác, một khối được chèn vào.  - gas: tổng số lượng gas đã dùng trong quá trình thực hiện giao dịch.  Trường này thường được dùng khi kiểm thử mạng để tìm lượng gas đã sử dụng trên mỗi khối.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| NetworksP2P    | CN/PN/EN | **[Dial] Add dial candidate from static nodes**  id=62a08a4b9f091c4b NodeType=0 ip=10.117.2.8 mainPort=32323 port=[32323] | Một mạng ngang hàng P2P mới được kết nối và đó là một nút tĩnh. Một nút được thêm thủ công bằng cách sử dụng api static-nodes.json hoặc addpeer được gọi là nút tĩnh. Nếu là mạng đa kênh, nó sử dụng hai cổng. vd. [32323, 32324].  - id: id mạng ngang hàng dst <br/> - NodeType: loại nút dst (cn,pn,en,bn) <br/> - ip: ip dst <br/> - mainPort: số cổng nghe TCP dst <br/> - port: số cổng nghe TCP dst bao gồm cả cổng chính và cổng phụ.                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| NetworksP2P    | CN/PN/EN | **Added a multichannel P2P Peer** id=28a6760472a078fb conn=staticdial peerID=28a6760472a078fb                                                                                                                                     | Một mạng ngang hàng mới được kết nối dưới dạng mạng ngang hàng đa kênh.  - id/peerID: id mạng ngang hàng nút của tôi <br/> - conn: kiểu kết nối <br/> - inbound: ai đó kết nối với tôi <br/> - staticdial: kết nối tĩnh, chẳng hạn như static-nodes.json hoặc addPeer <br/> - trusteddial: kết nối đang tin cậy, chẳng hạn như trust-nodes.json. luôn có thể kết nối lại và thiết lập ngay cả khi số lượng kết nối vượt quá giới hạn tối đa.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| NetworksP2P    | CN/PN/EN | **Disconnected a multichannel P2P Peer** id=28a6760472a078fb conn=inbound    peerID=28a6760472a078fb peerName=Klaytn/v1.7.3+acae89350c/darwin-arm64/go1.18.1 err=EOF                                                              | Một mạng ngang hàng đa kênh bị ngắt kết nối.  - peerName: Hiển thị thông tin nút của tôi <br/> - err: Lý do dẫn đến kết nối bị ngắt                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| NetworksP2P    | CN/PN/EN | **ProtocolManager.processConsensusMsg closed** id=28a6760472a078fb conn=inbound    PeerName=Klaytn/v1.7.3+acae89350c/darwin-arm64/go1.18.1                                                                                        | Khi một nút P2P bị ngắt kết nối, kênh thông báo đồng thuận giữa các nút cũng bị đóng.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| StorageStateDB | CN/PN/EN | **Persisted trie from memory database** blockNum=23460 updated nodes=4 updated nodes size=499.00B time=539.959µs  gcnodes=68  gcsize=10.55kB gctime=226.499µs  livenodes=245 livesize=37.80kB                                     | Nhật ký này được in để thông báo cho bạn rằng cơ sở dữ liệu trie đã được ghi lại. Ở đây, ghi lại có nghĩa là lưu trữ những thay đổi của cơ sở dữ liệu flushing vào cơ sở dữ liệu thực tế.  Thao tác ghi lại được thực hiện định kỳ.  - Trường hợp 1. Nếu nút đó là một nút hoàn thiện, việc ghi lại trie được thực hiện cho mỗi 128 khối.  - Trường hợp 2. Nếu nút đó là một nút lưu trữ, việc ghi lại trie được thực hiện cho mỗi khối.  Thao tác ghi lại cũng có thể được thực hiện trong các trường hợp khác.  - , Thao tác ghi lại được thực hiện khi một nút bị tắt.  - Thao tác ghi lại được thực hiện khi kích thước bộ nhớ vượt quá giới hạn.  Lưu ý.  - gc là viết tắt của garbage collection (thu gom rác). Ở đây, thu gom rác có nghĩa là lưu trữ các thay đổi của nút trie vào cơ sở dữ liệu flushing.  - Một nút hoàn thiện lưu trữ thông tin của mỗi 128 chu kỳ và 128 khối mới nhất.  - Một nút lưu trữ lưu trữ thông tin của mỗi khối. |
| Work           | CN       | **Commit new mining work** number=14 hash=438ef7…68ca7f txs=0 elapsed=605.375µs commitTime=184.708µs finalizeTime=414.375µs                                                                                                       | Mỗi nút CN đào một khối để chuẩn bị cho việc thay đổi vòng lặp <br/>-số hiệu: số khối<br/> - hàm băm: hàm băm của khối (đây không phải là phiên bản cuối cùng) <br/> - txs: số lượng giao dịch trong khối<br/> - thời gian trôi qua: tổng thời gian đào khối (commitTime + finalizeTime)<br/> - commitTime: thời gian thực thi giao dịch trong khối<br/> - finalizeTime: thời gian hoàn thành khối                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| Work           | CN       | **Successfully sealed new block** number=14 hash=13cbfc…f007fc                                                                                                                                                                    | [Chỉ Người đề xuất] Ghi đóng một khối mới thành công. Quá trình ghi đóng bao gồm các bước sau đây.  - Quá trình đồng thuận Ibft cho khối.  - Cập nhật dấu thời gian và chữ ký của khối                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Work           | CN       | **Successfully wrote mined block** num=14 hash=13cbfc…f007fc txs=0 elapsed=617.709µs                                                                                                                                              | [Chỉ Người đề xuất] Nếu nút đó là một người đề xuất và quá trình đồng thuận thành công thì người đề xuất cần lưu trữ kết quả thực thi của khối vào cơ sở dữ liệu. Nhật ký này cho biết việc lưu trữ đã thành công.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Work           | CN       | **Mining too far in the future** wait=1s                                                                                                                                                                                          | Để duy trì khoảng thời gian tạo khối 1 giây, nút sẽ ngủ trong thời gian "1s - thời gian tạo/lan truyền/ thực thi khối trước đó".  - wait: thời gian mà nút ngủ                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| VM             | CN/PN/EN | **Returning since the addr is not a program tài khoản** addr=                                                                                                                                                                     | Ai đó đang cố gắng gọi một hợp đồng không tồn tại.  Lưu ý. Trong Klaytn, tài khoản chương trình tương đương với tài khoản hợp đồng.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
